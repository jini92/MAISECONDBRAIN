# T003: 지식그래프 품질 분석 리포트

**날짜**: 2026-02-21
**분석 대상**: MAISECONDBRAIN 지식그래프 (.mnemo/graph.pkl)

## 1. 그래프 개요

| 지표 | 값 |
|------|----|
| 노드 | 2,533 |
| 엣지 | 30,842 |
| 밀도 | 0.0048 |
| Weakly Connected Components | 162 |

### 엔티티 타입 분포

| 타입 | 수 | 비고 |
|------|----|------|
| event | 1,067 | 이벤트/미팅/데일리 |
| project | 821 | 프로젝트 문서 |
| note | 300 | 일반 노트 |
| **unknown (미분류)** | **294** | 댕글링 참조 (파일 없음) |
| source | 51 | 출처/참고자료 |

### 엣지 타입 분포

| 타입 | 수 |
|------|------|
| wiki_link | 17,960 |
| related | 7,847 |
| tag_shared | 5,035 |

## 2. 컴포넌트 크기 분포

| 크기 | 컴포넌트 수 | 비율 |
|------|------------|------|
| **1 (고립 노드)** | **143** | 88.3% |
| 2 | 9 | 5.6% |
| 3-5 | 9 | 5.6% |
| 6-10 | 0 | 0% |
| 11-50 | 0 | 0% |
| 100+ | **1 (2,338 노드)** | 0.6% |

**핵심 발견**: 전체 162개 컴포넌트 중 143개(88%)가 단일 노드 고립. 메인 컴포넌트 1개가 2,338노드(92%)를 포함하며 그래프의 핵심. 나머지 19개는 2~5노드의 소규모 클러스터.

## 3. 고립 노드 분석 (143개 size=1 컴포넌트)

### 3.1 유형별 분류

고립 노드의 entity_type 분포:

- **event** (~48개): 날짜 기반 이벤트 노트 (예: `2024-01-08 - 코파일럿 사용`, `2025-02-09_희망퇴직 권고`)
- **project** (~70개): 프로젝트 문서/리포트 (예: `T-06_ES10500_Report_Generation_Issue_Analysis`, `I016-Backend-Phase1-Implementation`)
- **note** (~25개): 일반 노트, 템플릿, Untitled 문서, 데일리 노트

### 3.2 주요 원인

1. **위키링크 없는 노트**: frontmatter의 `related` 필드나 본문 `[[링크]]`가 없는 노트
2. **태그만 있는 노트**: `tag_shared` 엣지가 생성되지 않은 경우 (태그가 고유하거나 매칭 안 됨)
3. **MAIBEAUTY/MAIOSS 리포트 문서**: 자동 생성된 분석/테스트 리포트로 다른 노트와의 연결 없음
4. **오래된/일회성 노트**: 2024년 초반 노트들, CES 분석, 유튜브 요약 등

### 3.3 연결 가능성

| 카테고리 | 예상 수 | 연결 가능성 |
|----------|---------|------------|
| MAIOSS 리포트 (T-*, I-*, R-*) | ~30 | ⭐ 높음 - 프로젝트 노트에 related 추가 가능 |
| MAIBEAUTY 리포트 (A*, D*, I*, T*) | ~20 | ⭐ 높음 - 프로젝트 노트에 related 추가 가능 |
| 데일리/이벤트 노트 | ~48 | 🔶 중간 - 태그 기반 연결 가능 |
| Untitled/템플릿 | ~15 | ❌ 낮음 - 실질적 콘텐츠 없음 |
| 기타 일회성 노트 | ~30 | 🔶 중간 - 수동 분류 필요 |

## 4. Unknown (미분류) 엔티티 분석 (294개)

### 4.1 정체

294개 모두 **댕글링 참조** — 위키링크 `[[target]]`의 target이 실제 파일로 존재하지 않는 경우. 그래프에 빈 노드로 추가됨 (path 없음, entity_type 없음).

### 4.2 세부 분류

| 유형 | 수 | 설명 |
|------|----|------|
| 이미지 참조 (.png, .jpg 등) | 119 | `Pasted image *.png`, `IMG_*.png` 등 |
| 텍스트 참조 | 175 | 삭제/이동된 노트, 코드 스니펫, 깨진 링크 |

### 4.3 텍스트 참조 세부

- 삭제/이동된 노트 참조: `마이퍼니쳐싱크`, `기업여신 상담/심사 업무 영역 검증` 등
- 코드 파싱 오류: `str, Dict[str, Any`, `processor.tokenizer.unk_token_id` — 본문의 코드가 위키링크로 잘못 파싱됨
- Mermaid/HTML 파싱 오류: `MCP Servers<br/>GitHub·SDXL·GSheet`, `"👤 User"` 등
- 잘린 긴 노트명: `2025-05-06_삼성 엔지니어링_C&E...적요 7` 등

## 5. ontology.py 분류 로직 검토

현재 `classify_entity()` 로직:
1. YAML `type` 필드 → 직접 사용
2. 태그 키워드 매칭 → 점수 기반
3. 폴더 경로 힌트 → PARA 구조 매핑
4. 기본값 → `note`

**문제점**: 댕글링 참조 노드는 `classify_entity`를 거치지 않음 (NoteDocument가 아님). `graph_builder.py`에서 위키링크 타겟을 노드로 추가할 때 entity_type을 설정하지 않아 "unknown"으로 집계됨.

**개선 제안** (코드 수정 불필요, 빌더 레벨 처리):
- 이미지 확장자(.png/.jpg 등) → `entity_type="attachment"` 설정
- 나머지 댕글링 → `entity_type="dangling_ref"` 설정
- 코드/HTML 파싱 오류 → 파서의 위키링크 정규식 개선 필요

## 6. 개선 권고사항

### 즉시 가능 (자동화)
1. **댕글링 참조 분류**: graph_builder에서 파일 미존재 노드에 `entity_type` 부여
2. **파서 정규식 개선**: 코드 블록/HTML 내 `[[]]` 패턴 무시

### 중기 (반자동)
3. **고립 리포트 연결**: MAIOSS/MAIBEAUTY 리포트 문서에 `related` frontmatter 추가
4. **Untitled 정리**: 빈 Untitled 노트 아카이브 또는 삭제

### 장기
5. **태그 정규화**: 유사 태그 통합으로 tag_shared 엣지 증가
6. **자동 related 추천**: 임베딩 유사도 기반 관련 노트 추천

## 7. 요약

- 그래프는 **하나의 거대 컴포넌트(2,338노드, 92%)**로 잘 연결되어 있음
- 162개 소규모 컴포넌트 중 143개는 **단일 노드 고립** — 대부분 리포트/일회성 노트
- 294개 unknown은 모두 **댕글링 참조** (이미지 119 + 텍스트 175) — 분류 로직 문제 아님, 파일 부재
- 핵심 그래프 품질은 양호. 고립 노드는 전체의 5.6%에 불과
