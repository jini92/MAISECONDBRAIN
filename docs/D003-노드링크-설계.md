# D003-노드링크 설계: 지식그래프 구조 상세

**버전:** 1.0  
**작성일:** 2026-02-20  

---

## 1. 노드 설계

### 노드 = Obsidian 마크다운 파일

볼트의 모든 `.md` 파일이 하나의 노드.

```
┌──────────────────────────────┐
│ ID: 파일명 (stem)             │
│ Type: concept / project / ...│
│ Properties: YAML frontmatter │
│ Content: 본문 텍스트          │
│ Embedding: 벡터 (캐시)       │
└──────────────────────────────┘
```

### MAIBOT 볼트 실측 규모

| 데이터 소스 | 규모 |
|------------|------|
| 전체 노드 | **3,037개** .md 파일 |
| Daily Notes | 1,218개 |
| 프로젝트 문서 | ~750개 (13개 프로젝트) |
| 기타 (Area/Resource) | ~1,000개 |
| MAIBOT memory | 23개 파일 |

---

## 2. 링크 설계

### 3가지 소스에서 자동 추출

```
1. [[위키링크]]  ─── 본문에서 직접 참조          (강한 연결)
2. YAML 관계    ─── frontmatter의 관계 필드      (강한 연결)
3. 태그 공유    ─── 같은 #태그를 가진 노트 간     (약한 연결)
```

### 링크 타입 상세

| 링크 타입 | 추출 소스 | 강도 | 방향 | 예시 |
|----------|----------|------|------|------|
| `wiki_link` | 본문 `[[A]]` | 강함 | A → B | `[[GraphRAG]]`를 언급하면 연결 |
| `explicit_relation` | YAML `related:` | 강함 | 양방향 | `related: ["[[온톨로지]]"]` |
| `uses` | YAML `uses:` | 강함 | A → B | 프로젝트 → 도구 |
| `used_in` | YAML `used_in:` | 강함 | A ← B | 도구 → 프로젝트 |
| `source` | YAML `source:` | 중간 | A → B | 인사이트 → 출처 |
| `derived_from` | YAML `derived_from:` | 중간 | A → B | 파생 관계 |
| `supports` | YAML `supports:` | 중간 | A → B | 개념 간 지지 |
| `contradicts` | YAML `contradicts:` | 중간 | A ↔ B | 개념 간 반박 |
| `applied_to` | YAML `applied_to:` | 중간 | A → B | 인사이트 → 프로젝트 |
| `tag_cooccurrence` | 동일 `#태그` | 약함 | 양방향 | 둘 다 `#ai` 태그 |

### 가중치 설계

```python
EDGE_WEIGHTS = {
    "wiki_link": 1.0,           # 직접 참조 = 가장 강한 연결
    "explicit_relation": 0.9,   # 명시적 관계
    "uses": 0.8,                # 사용 관계
    "used_in": 0.8,             # 역방향 사용
    "source": 0.7,              # 출처
    "derived_from": 0.7,        # 파생
    "applied_to": 0.7,          # 적용
    "supports": 0.6,            # 지지
    "contradicts": 0.6,         # 반박 (부정이지만 강한 연결)
    "tag_cooccurrence": 0.2,    # 태그 공유 = 약한 연결
}
```

---

## 3. 실제 그래프 예시: MAIBOT 볼트 기준

```
                    ┌─────────┐
                    │ 팔란티어 │ (concept)
                    └────┬────┘
                         │ wiki_link
                    ┌────┴────┐
        ┌───────────┤ GraphRAG │ (concept)
        │           └────┬────┘
        │ supports       │ related
        │           ┌────┴──────────┐
        │           │ 온톨로지       │ (concept)
        │           └────┬──────────┘
        │                │ applied_to
   ┌────┴──────────┐     │
   │ MAISECONDBRAIN ├─────┘ (project)
   └────┬──────────┘
        │ uses
   ┌────┴────┐    ┌──────────┐
   │NetworkX │    │ Obsidian  │ (tool)
   └─────────┘    └────┬─────┘
                       │ used_in
              ┌────────┼────────┐
              ▼        ▼        ▼
          MAIOSS   MAIAX    MAIBEAUTY  (project)
              │
              │ wiki_link
              ▼
         ┌─────────┐
         │ CVE DB   │ (concept)
         └─────────┘
```

### 예상 그래프 규모

```
├── 노드: ~3,037개 (파일 1개 = 노드 1개)
├── wiki_link 엣지: ~15,000+ (노트당 평균 5개 링크)
├── YAML 관계 엣지: ~2,000 (frontmatter 있는 파일)
├── 태그 공유 엣지: ~50,000+ (같은 태그끼리)
└── 총 엣지: ~67,000+
```

### 크로스 프로젝트 추론 예시

> 질문: "MAIOSS에서 쓴 GraphRAG 기술이 다른 프로젝트에도 적용 가능한가?"

```
MAIOSS →(uses)→ GraphRAG →(applied_to)→ MAISECONDBRAIN
                         →(related)→ 온톨로지 →(used_in)→ MAIAX
```

2-3홉 탐색으로 프로젝트 간 연결을 자동 추론.

---

## 4. 옵시디언 적용 방법

### 핵심 원칙: 기존 워크플로우 변경 = 0

```
Before Mnemo:  노트 쓴다 → [[링크]] 건다 → Graph View로 본다
After Mnemo:   노트 쓴다 → [[링크]] 건다 → Graph View로 본다
                                          + AI가 관계 추론해서 답변
                                          + 관련 노트 자동 추천
                                          + 크로스 프로젝트 연결 발견
```

Mnemo는 뒤에서 **읽기만** 한다. 쓰면 쓸수록 그래프가 풍성해지고 AI 답변이 정확해지는 구조.

### Step 1: 기존 노트 — 수정 불필요

지금 있는 `[[위키링크]]`와 `#태그`만으로 그래프 동작. 추가로 `type:` 필드를 넣으면 더 정밀한 분류 가능:

```markdown
---
type: concept          ← 이거 하나만 추가 (선택)
tags: [ai, graphrag]   ← 이미 있으면 그대로
---

# GraphRAG 개념 정리
[[팔란티어]]의 사례에서 보듯...  ← 기존 위키링크 = 자동 엣지
```

### Step 2: Mnemo 파서가 백그라운드에서 처리

```
옵시디언에서 노트 편집 (평소대로)
    ↓ 자동 감지 (크론 or watchdog)
Mnemo 파서 (Python, 백그라운드)
    ↓ YAML + [[링크]] + #태그 추출
NetworkX 그래프 업데이트 (증분, ~5초)
    ↓
벡터 임베딩 갱신 (변경분만)
    ↓
검색 준비 완료
```

### Step 3: 질의 방법 3가지

#### A. MAIBOT (Discord) — Phase 1부터 사용 가능

```
지니: "MAIOSS에서 GraphRAG 관련 작업 내역은?"
MAIBOT: (Mnemo GraphRAG 검색) → 관련 노트 5개 + 관계도 + 답변
```

#### B. Obsidian 플러그인 — Phase 3에서 개발

```
옵시디언 사이드바:
┌────────────────────────────┐
│ 🔍 Mnemo Query             │
│ ┌────────────────────────┐ │
│ │ GraphRAG와 관련된 프로  │ │
│ │ 젝트에서 배운 교훈은?   │ │
│ └────────────────────────┘ │
│ [검색]                     │
│                            │
│ 📄 답변:                   │
│ MAIOSS에서 GraphRAG를...   │
│                            │
│ 📎 소스 노트:              │
│ • [[memory/maioss.md]]     │
│ • [[A003-기술분석]]        │
│                            │
│ 🔗 관계 경로:              │
│ MAIOSS →uses→ GraphRAG     │
│   →applied_to→ MAISECONDBRAIN │
└────────────────────────────┘
```

#### C. CLI — 개발/디버그용

```bash
python -m mnemo query "온톨로지 관련 인사이트 요약"
python -m mnemo stats
python -m mnemo neighbors "GraphRAG" --hops 2
```

### 기존 자산 활용 매핑

| 이미 있는 것 | Mnemo 활용 방식 |
|-------------|---------------|
| `[[위키링크]]` (대량) | → **엣지** 자동 추출 |
| `#태그` | → 약한 연결 + 도메인 분류 |
| YAML frontmatter (Dashboard, Kanban) | → 노드 속성 |
| 폴더 구조 (00.DAILY, 01.PROJECT...) | → 컨텍스트 힌트 |
| Dataview 쿼리 | → 기존 것 그대로 사용 |
| Graph View | → 기존 것 + Mnemo 추론이 보강 |

---

## 5. 점진적 도입 전략

| 단계 | 사용자 액션 | Mnemo 효과 |
|------|-----------|-----------|
| **0. 즉시** | 아무것도 안 함 | `[[위키링크]]` + `#태그`로 기본 그래프 |
| **1. 선택적** | 주요 노트에 `type:` 추가 | 엔티티 분류 정밀화 |
| **2. 자동** | Mnemo가 AI로 `type:` 자동 분류 제안 | 수동 작업 최소화 |
| **3. 고도화** | `related:`, `uses:` 등 YAML 관계 추가 | 명시적 관계 강화 |

**철학: 처음부터 완벽한 스키마를 강요하지 않는다.** `[[링크]]`만 걸어도 동작하고, 점진적으로 풍성해진다.

---

*Created: 2026-02-20 by MAIBOT*
