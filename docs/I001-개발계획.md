# I001-개발계획: Mnemo Phase 1 — MAIBOT 적용

**버전:** 1.0  
**작성일:** 2026-02-20  

---

## 1. 적용 대상: MAIBOT 현재 환경

### 기존 데이터 자산

| 데이터 소스 | 규모 | 위치 |
|------------|------|------|
| Obsidian 볼트 (your-vault) | **3,037개** .md 파일 | `~/vault` |
| ├ Daily Notes | 1,218개 | `00.DAILY/` |
| ├ 프로젝트 문서 | ~750개 (13개 프로젝트) | `01.PROJECT/` |
| └ 기타 (Area/Resource/etc) | ~1,000개 | `02~05/`, 기타 |
| MAIBOT memory | **23개** 파일 (~2,000줄) | `$MNEMO_MEMORY_PATH/` |
| 프로젝트 docs | 프로젝트별 `docs/` | `C:\TEST\MAI*/docs/` |

### 현재 MAIBOT의 지식 검색 방식

```
사용자 질문
    ↓
memory_search (시맨틱 검색, MEMORY.md + memory/*.md만 대상)
    ↓
memory_get (스니펫 읽기)
    ↓
답변
```

**한계:**
- Obsidian 볼트 3,037개 파일은 검색 대상이 아님
- 프로젝트 간 크로스 참조 추론 불가
- 관계 기반 탐색 없음 (벡터 유사도만)

### Mnemo 적용 후

```
사용자 질문
    ↓
Mnemo GraphRAG (벡터 + 그래프 하이브리드)
    ↓ 대상: 볼트 3,037 파일 + memory 23 파일 + 프로젝트 docs
    ↓ 그래프 탐색으로 크로스 프로젝트 추론
    ↓
기존 memory_search 보강/대체
    ↓
답변 (소스 노트 인용 포함)
```

---

## 2. Phase 1 개발 범위 (4주)

### Sprint 1: 볼트 파서 + 그래프 빌더 (Week 1-2)

| # | 태스크 | 산출물 | 예상 시간 |
|---|--------|--------|----------|
| 1.1 | Python 프로젝트 초기화 | `pyproject.toml`, 의존성 설정 | 2h |
| 1.2 | Obsidian 마크다운 파서 | `src/core/parser.py` — YAML + 위키링크 + 태그 추출 | 8h |
| 1.3 | 온톨로지 엔진 | `src/core/ontology.py` — 엔티티 자동 분류 | 6h |
| 1.4 | NetworkX 그래프 빌더 | `src/core/graph_builder.py` — 볼트 → 그래프 변환 | 6h |
| 1.5 | 증분 빌드 + 캐시 | `src/core/cache.py` — 파일 해시 기반 변경 감지 | 4h |
| 1.6 | CLI 도구 | `src/cli.py` — `mnemo build`, `mnemo stats` | 3h |
| 1.7 | 테스트 | your-vault 볼트 대상 실제 빌드 테스트 | 3h |

**Sprint 1 완료 기준:** `mnemo build` 실행 시 3,037개 파일에서 그래프 생성, 노드/엣지 통계 출력

### Sprint 2: 임베딩 + GraphRAG 쿼리 (Week 3-4)

| # | 태스크 | 산출물 | 예상 시간 |
|---|--------|--------|----------|
| 2.1 | 임베딩 생성기 | `src/core/embedder.py` — OpenAI/Ollama 지원 | 6h |
| 2.2 | 임베딩 캐시 | `.mnemo/embeddings/` — 변경 파일만 재생성 | 4h |
| 2.3 | 벡터 검색 엔진 | `src/core/vector_search.py` — 코사인 유사도 | 4h |
| 2.4 | 그래프 탐색 엔진 | `src/core/graph_search.py` — BFS, PageRank, 서브그래프 | 6h |
| 2.5 | GraphRAG 쿼리 엔진 | `src/core/graphrag.py` — 하이브리드 검색 + LLM 답변 | 8h |
| 2.6 | REST API 서버 | `src/api/server.py` — FastAPI, localhost:7890 | 4h |
| 2.7 | MAIBOT 연동 | OpenClaw 스킬로 등록, memory_search 보강 | 6h |
| 2.8 | 통합 테스트 | 실제 질문으로 end-to-end 테스트 | 4h |

**Sprint 2 완료 기준:** "MAIOSS에서 GraphRAG 관련 작업 내역은?" 같은 크로스 프로젝트 질문에 소스 인용 포함 답변

---

## 3. 기술 설계 결정

### 3.1 Python 환경

```
Python 3.13+ (이미 설치됨)
├── networkx          # 그래프 엔진
├── pyyaml            # YAML 파싱
├── numpy             # 벡터 연산
├── fastapi + uvicorn # REST API
├── openai            # 임베딩/LLM (OpenAI API)
├── ollama            # 로컬 LLM 대안
└── rich              # CLI 출력
```

### 3.2 임베딩 전략

| 옵션 | 모델 | 비용 | 3,037파일 예상 |
|------|------|------|---------------|
| **OpenAI** | text-embedding-3-small | $0.02/1M tokens | ~$0.5 (초회) |
| **Ollama** | nomic-embed-text | 무료 (로컬) | ~30분 (RTX 4070S) |

→ **초기: OpenAI** (빠른 프로토타이핑) → **프로덕션: Ollama** (비용 0)

### 3.3 LLM 전략

- 쿼리 답변: Claude API (기존 MAIBOT 연동)
- 엔티티 분류 fallback: Ollama (로컬, 배치)
- 임베딩: OpenAI or Ollama

### 3.4 캐시 구조

```
.\.mnemo/
├── checksums.json       # { "파일경로": "sha256해시" }
├── graph.pkl            # NetworkX 그래프 직렬화
├── embeddings/
│   ├── index.json       # { "파일경로": "임베딩파일명" }
│   └── *.npy            # numpy 배열
└── stats.json           # 빌드 통계
```

### 3.5 MAIBOT 연동 방식

**Option A: OpenClaw 스킬** (선택)
```
skills/mnemo/
├── SKILL.md
├── search.py     # GraphRAG 쿼리
└── build.py      # 그래프 빌드 (크론용)
```

MAIBOT이 질문받으면 → `mnemo search` 스킬 호출 → GraphRAG 결과 반환

**Option B: memory_search 확장**
기존 `memory_search` 도구에 Mnemo 백엔드 추가 (OpenClaw 코어 수정 필요 → 나중에)

---

## 4. 성능 목표

| 지표 | 목표 |
|------|------|
| 볼트 전체 빌드 (초회) | < 60초 |
| 증분 빌드 | < 5초 |
| 그래프 메모리 | < 100MB (3,037 노드) |
| 임베딩 생성 (초회, OpenAI) | < 5분 |
| 쿼리 응답 시간 | < 3초 (검색) + LLM 시간 |

---

## 5. 리스크 & 대응

| 리스크 | 대응 |
|--------|------|
| 한글 YAML 파싱 오류 | UTF-8 강제, 인코딩 감지 fallback |
| 깨진 위키링크 | 존재하지 않는 노드도 그래프에 포함 (dangling node) |
| 대규모 Daily Notes (1,218개) | 날짜 기반 필터링 옵션, 오래된 노트는 가중치 감소 |
| OneDrive 동기화 충돌 | 읽기 전용 접근, 쓰기는 `.mnemo/` 캐시만 |
| Ollama 메모리 부족 | 배치 사이즈 조정, OpenAI fallback |

---

## 6. 마일스톤

| 주차 | 마일스톤 | 검증 |
|------|---------|------|
| **W1** | 볼트 파서 + 그래프 빌더 완성 | `mnemo build` → 3,037 노드 그래프 |
| **W2** | 증분 빌드 + CLI + 통계 | `mnemo stats` → Top 10 허브 노드 |
| **W3** | 임베딩 + 하이브리드 검색 | `mnemo query "질문"` → 관련 노트 반환 |
| **W4** | LLM 답변 + MAIBOT 연동 | MAIBOT에서 GraphRAG 질의 가능 |

---

*Created: 2026-02-20 by MAIBOT*
